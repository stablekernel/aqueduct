language: dart
dart:
  - dev
addons:
  postgresql: "9.6"

services:
  - postgresql

before_install:
  - bash ci/before_install.sh

env:
  - TEST_DIR=aqueduct_test
  - TEST_DIR=aqueduct

after_success:
  - bash ci/after_script.sh

jobs:
  include:
    - stage: test
      script: bash ci/script.sh

stages:
  - test

matrix:
  exclude:
    - dart: dev
      env: STAGE=coverage

branches:
  only:
    - master
    - 3.0
